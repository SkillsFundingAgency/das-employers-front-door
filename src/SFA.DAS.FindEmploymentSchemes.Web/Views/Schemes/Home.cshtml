@model HomeModel

@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

@section PreviewErrors {

    @await Html.PartialAsync("_PreviewErrorsPartial", Model.Preview)

}

@await Html.PartialAsync(
    
    "_PreambleBannerPartial", 
    
    new Tuple<string, string, IHtmlContent?>(string.Empty, string.Empty, @Model.Preamble)

)

@{

    string completeUrl = Url.Action("Home", "Schemes", null, protocol: HttpContextAccessor.HttpContext.Request.Scheme);

}


<div class="govuk-width-container govuk-!-padding-top-6 das-column__filters">

    <div id="scheme-home-filter-outer" class="govuk-grid-row app-filter-layout">

        <div id="scheme-home-filter-inner" class="govuk-grid-column-one-third app-filter-layout__filter filters_mobile_hidden">

            <div id="scheme-filter" class="das-filter app-filter @(Model.EnsureSchemesAreVisible?"app-hide-on-mobile-no-js":"")" tabindex="0" data-module="app-show-hide">

                <form id="scheme-home-filter-form" action="/" method="post">

                    <h2 id="filters" class="das-filter__heading govuk-!-margin-bottom-0">Filters</h2>

                    <a id="close-filter" class="govuk-link desktop_hidden">Back</a>

                    <div id="scheme-filter-options" class="das-filter__body">

                        @foreach (var filter in Model.Filters)
                        {

                            @await Html.PartialAsync("_FilterGroupPartial", filter)

                        }

                        <div id="scheme-home-filter-form-button-group" class="govuk-button-group">

                            <button id="filter-box-filter-schemes" class="das-button__primary govuk-!-margin-bottom-0 govuk-!-width-full">Filter schemes</button>

                        </div>

                        <div id="scheme-home-filter-form-button-group" class="govuk-button-group">

                            <a id="clear-filters" asp-route="@(Model.Preview.IsPreview ? "home-preview" : "home")" class="das-button__secondary govuk-!-width-full">Clear filters</a>

                        </div>

                    </div>

                </form>

            </div>

        </div>

        <div id="schemes" class="govuk-grid-column-two-thirds app-filter-layout__content">

            <div class="govuk-grid-column-full govuk-!-padding-0">

                <a id="filter-schemes" class="das-button__primary desktop_hidden" aria-controls="scheme-filter" aria-expanded="false" tabindex="110">Filter schemes</a>

            </div>

            <div class="govuk-grid-column-full govuk-!-padding-0">

                <label class="govuk-heading-s">Number of schemes: @Model.Schemes.Count()</label>

            </div>

            <div class="govuk-grid-column-full govuk-!-padding-0 govuk-!-padding-top-2 govuk-!-padding-bottom-2">

                <a id="compare-schemes" class="govuk-link" asp-route="@(Model.Preview.IsPreview ? "scheme-comparison-preview" : "scheme-comparison")">Compare these schemes in a table</a>

            </div>

            @foreach (var scheme in Model.Schemes)
            {

                @await Html.PartialAsync("_SchemePartial", (scheme, Model.Preview))

            }

        </div>

    </div>

</div>

@await Html.PartialAsync("_SharePagePartial", completeUrl)

<script asp-add-nonce>

    document.addEventListener("DOMContentLoaded", function() {

        initMobileView();

    });

</script>